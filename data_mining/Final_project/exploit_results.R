#This files is there to show the result
#obtained with the final exam, without recompiling everything

######### Cleaning workspace ######### 
rm(list=ls())
graphics.off()

######### Hopkins statistic #########
load(file="C:\\Users\\maeli\\Documents\\INSA\\4A\\Taltech\\data_mining\\Final_project\\data\\result_hopkins.RData")

cat("Hopkins statistic is ", hopkins, "\n")

load(file="C:\\Users\\maeli\\Documents\\INSA\\4A\\Taltech\\data_mining\\Final_project\\data\\new_try.RData")

######### Kmeans #########

#load(file="C:\\Users\\maeli\\Documents\\INSA\\4A\\Taltech\\data_mining\\Final_project\\data\\result_kmeans.RData")

labels <- sort(unique(classified[,ncol(classified)]))
cat("Existing labels : ", labels, "\n")
#We know we need 5 labels so we will just use it

nb_values <- nrow(classified)
repartition <- c()
for(i in labels)
{
  tmp <- nrow(classified[classified[,ncol(classified)]==i,])
  cat("[Label ", i, "] ", tmp, " values (", (tmp/nb_values)*100, "%)\n")
}

######### Silhouette #########
#load(file="C:\\Users\\maeli\\Documents\\INSA\\4A\\Taltech\\data_mining\\Final_project\\data\\result_sil_unordered.RData")
#load(file="C:\\Users\\maeli\\Documents\\INSA\\4A\\Taltech\\data_mining\\Final_project\\data\\result_sil_ordered.RData")


plot(1:nrow(cluster_with_sil),
     cluster_with_sil$Silhouette_value, type="h", xaxt = "n", xlab = "Cluster label",
     ylab = "Silhouette", col=cluster_with_sil$Cluster)


######### Other stat #########

cl1 <- classified[classified[,ncol(classified)]==1,]
questions <- 1:50
values1 <- colSums(cl1)

cl2 <- classified[classified[,ncol(classified)]==2,]
values2 <- colSums(cl2)

cl3 <- classified[classified[,ncol(classified)]==3,]
values3 <- colSums(cl3)

cl4 <- classified[classified[,ncol(classified)]==4,]
values4 <- colSums(cl4)

cl5 <- classified[classified[,ncol(classified)]==5,]
values5 <- colSums(cl5)

plot(questions, values1[1:length(values1)-1], ylim=c(0,3000),xlim=c(0,50),type='h')
plot(questions, values2[1:length(values2)-1],ylim=c(0,3000),xlim=c(0,50),type='h', col=2)
plot(questions, values3[1:length(values3)-1],ylim=c(0,3000),xlim=c(0,50),type='h', col=3)
plot(questions, values4[1:length(values4)-1],ylim=c(0,3000),xlim=c(0,50),type='h', col=4)
plot(questions, values5[1:length(values5)-1],ylim=c(0,3000),xlim=c(0,50),type='h', col=5)
